# Practical Case – Ingestion and Detection of Failed Authentication Events in Splunk

## 1. Objective

Configure the collection of Windows security events using the **Splunk Universal Forwarder** and validate the **detection of failed authentication attempts (Event ID 4625)** in the SIEM.

---

## 2. Lab Architecture

### Infrastructure

* **VM 1 – Ubuntu**

  * Docker container running **Splunk Enterprise**
  * Role: **Indexer + Search Head**
  * Log reception port: **9997/tcp**

* **VM 2 – Windows 11**

  * **Splunk Universal Forwarder**
  * Collecting:

    * `WinEventLog://Security`

### Data Flow

Windows Security Log
→ Universal Forwarder
→ Splunk Indexer (Docker on Ubuntu)
→ Search and analysis in Splunk Web

---

## 3. Configuration Performed

### 3.1 Forwarding to the indexer

File:

```
outputs.conf
```

Configuration:

```
[tcpout]
defaultGroup = default-autolb-group

[tcpout:default-autolb-group]
server = <INDEXER_IP>:9997
```

Validation:

```
splunk list forward-server
```

Expected result:

```
Active forwards: <IP>:9997
```

---

### 3.2 Security event collection

File:

```
inputs.conf
```

Configuration:

```
[WinEventLog://Security]
disabled = 0
index = windows
renderXml = true
```

Validation:

```
splunk list inputstatus
```

Reading confirmation via:

```
splunkd.log → active connection to indexer
```

---

## 4. Verification on Windows

Direct query of the Security log:

```
wevtutil qe Security /q:"*[System[(EventID=4625)]]" /c:3 /f:text
```

Result:

* **4625 – Logon Failure** events present
* Generated by authentication attempts with incorrect passwords

This confirms:

✔ Correct event generation on the host
✔ Valid SIEM data source

---

## 5. Issue Identified

### Symptom

Search in Splunk:

```
index=windows EventCode=4625
```

Result:

```
0 events
```

### Key observation

Alternative search:

```
index=* "4625"
```

**Does return results.**

---

## 6. Root Cause

Events are indexed with:

```
sourcetype = XmlWinEventLog:Security
```

In this sourcetype:

* The field **`EventCode` does not exist**
* The real identifier is:

```
EventID
```

Additionally:

* The **Splunk Add-on for Microsoft Windows** is missing on the indexer/search head
* Therefore **CIM-compatible field extractions are not performed**

---

## 7. Technical Resolution

### Quick operational workaround

Search raw text:

```
index=* "4625"
```

Valid for:

* Triage
* Lab environments
* Rapid investigation

---

### Proper production solution

Install on the indexer/search head:

```
Splunk Add-on for Microsoft Windows
```

This enables:

* `EventCode` extraction
* CIM normalization
* Standard SOC searches:

```
EventCode=4625
```

---

## 8. Final Validation

Working search:

```
index=* "4625" earliest=-5m
| table _time host source
```

Result:

✔ Failed authentication events visible
✔ UF → Indexer pipeline operational

---

## 9. SOC Environment Impact

This case reproduces a **very common real-world SIEM issue**:

* Logs successfully ingested
* But **without field normalization**
* Leading to:

  * Broken detections
  * Missing alerts
  * False negatives

### Key lesson

In a SIEM:

> **Log ingestion alone is not enough.
> Without parsing and normalization, there is no real detection.**

---

## 10. Recommended Next Steps

1. Install the **Splunk Add-on for Microsoft Windows**
2. Create detections for:

   * **Brute-force attempts**
   * **Successful logon after multiple failures**
3. Build:

   * **SOC alert**
   * **Authentication monitoring dashboard**

---

## 11. Conclusion

Achieved outcomes:

* Functional deployment of **Splunk + Universal Forwarder**
* Real ingestion of **Windows security events**
* Identification and analysis of a **parsing issue**
* Manual validation of **failed login attempts**

This exercise reproduces a realistic scenario of **SIEM engineering and SOC operations**.